./byfn.sh up -c mychannel -n

docker exec -it cli bash
 
peer chaincode install -n token_erc20 -v 1.0 -p github.com/chaincode/token-erc-20/go 

export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
export CORE_PEER_ADDRESS=peer0.org2.example.com:9051
export CORE_PEER_LOCALMSPID="Org2MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
export CORE_PEER_TLS_ENABLED=true 

peer chaincode install -n token_erc20 -v 1.0 -p github.com/chaincode/token-erc-20/go 

export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export CORE_PEER_LOCALMSPID="Org1MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_TLS_ENABLED=true 

peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n token_erc20 -v 1.0 -c '{"Args":["Init"]}' -P "AND ('Org1MSP.peer','Org2MSP.peer')"

export TARGET_TLS_OPTIONS=(-o orderer.example.com:7050 --tls --cafile "/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem" --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles "/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt" --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles "/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt")

peer chaincode invoke -o orderer.example.com:7050 --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n token_erc20 --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt -c '{"function":"PrintCreatorAddress", "Args":[]}'

// Approve
Mở terminal mới và cd vào first-network

export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export CORE_PEER_LOCALMSPID="Org1MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_TLS_ENABLED=true 


// Gọi hàm
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Initialize","Args":["ExampleToken","ETK","5000","18"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Mint","Args":["5000"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"ClientAccountBalance","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"ClientAccountID","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"transfer","Args":["'"$RECIPIENT"'","100"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Approve","Args":[ "'"$SPENDER"'","500"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Allowance","Args":["'"$MINTER"'", "'"$SPENDER"'"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"transferFrom","Args":[ "'"$MINTER"'", "'"$RECIPIENT"'", "100"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"balanceOf","Args":["'"$MINTER"'"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"name","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"symbol","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"totalSupply","Args":[]}'


- balanceOf là hàm yêu cầu lại số dư tài khoản của mint (totalSupply) trên tất cả các org và nó cần tham số truyền vào là account_ID_Org1_miner
- ClientAccountBalance là hàm yêu cầu số dư của người nhận hiện tại của org terminal đó
- transfer nó cần tham số truyền vào là  account_ID_org2
- transfer from (Chuyển khoản của bên thứ 3) là hoạt động trên terminal mới đại điện cho minter (mặc định org1) cần hai tham số truyền vào là  account_ID_Org1_miner và account ID Org2 


account ID Org1_miner =
eDUwOTo6Q049bWludGVyLE9VPWNsaWVudCxPPUh5cGVybGVkZ2VyLFNUPU5vcnRoIENhcm9saW5hLEM9VVM6OkNOPWNhLm9yZzEuZXhhbXBsZS5jb20sTz1vcmcxLmV4YW1wbGUuY29tLEw9RHVyaGFtLFNUPU5vcnRoIENhcm9saW5hLEM9VVM

// a 3rd terminal to represent the spender in Org1
account ID Org1_spender = eDUwOTo6Q049c3BlbmRlcixPVT1jbGllbnQsTz1IeXBlcmxlZGdlcixTVD1Ob3J0aCBDYXJvbGluYSxDPVVTOjpDTj1jYS5vcmcxLmV4YW1wbGUuY29tLE89b3JnMS5leGFtcGxlLmNvbSxMPUR1cmhhbSxTVD1Ob3J0aCBDYXJvbGluYSxDPVVT

account ID Org2 = eDUwOTo6Q049cmVjaXBpZW50LE9VPWNsaWVudCxPPUh5cGVybGVkZ2VyLFNUPU5vcnRoIENhcm9saW5hLEM9VVM6OkNOPWNhLm9yZzIuZXhhbXBsZS5jb20sTz1vcmcyLmV4YW1wbGUuY29tLEw9SHVyc2xleSxTVD1IYW1wc2hpcmUsQz1VSw


// encodedClientID := base64.StdEncoding.EncodeToString(clientID)
CgdPcmcxTVNQEqoGLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNLVENDQWMrZ0F3SUJBZ0lRWUUrNVloMGhwOW9jQlB3dEFrazZNakFLQmdncWhrak9QUVFEQWpCek1Rc3cKQ1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ4TU5VMkZ1SUVaeQpZVzVqYVhOamJ6RVpNQmNHQTFVRUNoTVFiM0puTVM1bGVHRnRjR3hsTG1OdmJURWNNQm9HQTFVRUF4TVRZMkV1CmIzSm5NUzVsZUdGdGNHeGxMbU52YlRBZUZ3MHlOREExTWpRd056RTJNREJhRncwek5EQTFNakl3TnpFMk1EQmEKTUdzeEN6QUpCZ05WQkFZVEFsVlRNUk13RVFZRFZRUUlFd3BEWVd4cFptOXlibWxoTVJZd0ZBWURWUVFIRXcxVApZVzRnUm5KaGJtTnBjMk52TVE0d0RBWURWUVFMRXdWaFpHMXBiakVmTUIwR0ExVUVBd3dXUVdSdGFXNUFiM0puCk1TNWxlR0Z0Y0d4bExtTnZiVEJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCQ1J3T2R0dTMvUnYKQjN2OXhkYi9aVVl0SlZWeUcyNFBpZEJIa3Y5OGM2RDNWNEZYeFE2MVdSQnFxUWcyRkZ6MnhUTFVHY215cFpqTQplTkJ0ZnBiMmZaR2pUVEJMTUE0R0ExVWREd0VCL3dRRUF3SUhnREFNQmdOVkhSTUJBZjhFQWpBQU1Dc0dBMVVkCkl3UWtNQ0tBSUpiRHZ1ME1VazYySUpHSWtUd0ptNm9pQlN5RTJVOUExN0VZMkt0ODBEWjhNQW9HQ0NxR1NNNDkKQkFNQ0EwZ0FNRVVDSVFEdEhmeDVLWWUvVFV0YU4wWHhqMkdQNTlyWkRCc0tRZUViSEJpZFhoNlU1UUlnWmpxbApnRlgzWFNtSmhmNTlnbEFIeDMyQnB1ZVFKTU9pQmZCUmpuM1NpUWM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K

// addressHex := hex.EncodeToString([]byte(clientID))
0a074f7267314d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b44434341632b674177494241674951487154697745587a4c674e4768514b6c496b4346487a414b42676771686b6a4f50515144416a427a4d5173770a435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e5532467549455a790a5957356a61584e6a627a455a4d4263474131554543684d5162334a6e4d53356c654746746347786c4c6d4e76625445634d426f474131554541784d54593245750a62334a6e4d53356c654746746347786c4c6d4e7662544165467730794e4441314d6a51784d544d774d4442614677307a4e4441314d6a49784d544d774d4442610a4d477378437a414a42674e5642415954416c56544d524d77455159445651514945777044595778705a6d3979626d6c684d5259774641594456515148457731540a59573467526e4a68626d4e7063324e764d513477444159445651514c457756685a473170626a45664d4230474131554541777757515752746157354162334a6e0a4d53356c654746746347786c4c6d4e766254425a4d424d4742797147534d34394167454743437147534d343941774548413049414247526d634362564b3767460a7a2f6e4c6d5930454841636c44504f4a30667864335155466547483979576a6b5835334a684737546563526c527172774365594f482b486a30794577717868530a4c62544a6c7336623446576a5454424c4d41344741315564447745422f775145417749486744414d42674e5648524d4241663845416a41414d437347413155640a4977516b4d434b41494b6a654d4338766a6f7949667670474c6e394542616d4d575a6a4d66515657647952384a724444354a6c644d416f4743437147534d34390a42414d43413063414d455143494631436d6768734f34772f7354702f686c6153694c57513959312f68716d5646756a49522b34505152414a41694239375965300a334f4d687a4c3765346d2f584c39373964617848744b58484b4664444a65693677344e7270513d3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a

-- ClientID-org1-miner
export MINTER="0a074f7267314d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b54434341632b674177494241674951425331465072625551756e6a64777770525867534c7a414b42676771686b6a4f50515144416a427a4d5173770a435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e5532467549455a790a5957356a61584e6a627a455a4d4263474131554543684d5162334a6e4d53356c654746746347786c4c6d4e76625445634d426f474131554541784d54593245750a62334a6e4d53356c654746746347786c4c6d4e7662544165467730794e4441314d6a55784d444d794d4442614677307a4e4441314d6a4d784d444d794d4442610a4d477378437a414a42674e5642415954416c56544d524d77455159445651514945777044595778705a6d3979626d6c684d5259774641594456515148457731540a59573467526e4a68626d4e7063324e764d513477444159445651514c457756685a473170626a45664d4230474131554541777757515752746157354162334a6e0a4d53356c654746746347786c4c6d4e766254425a4d424d4742797147534d34394167454743437147534d3439417745484130494142504564367644745151484d0a6c497435347075366978324b39427736504364764c77766e7869372f6f2f3567384957372f6444683931474d63744f732b71646855715479623845514130475a0a4646666b3469396b4743756a5454424c4d41344741315564447745422f775145417749486744414d42674e5648524d4241663845416a41414d437347413155640a4977516b4d434b41494a4d66492b6d7771796b31464948726e68677135587a6d6a79424e66312f50454d456f30524f556e3976324d416f4743437147534d34390a42414d43413067414d455543495144614a74356b67773267366a4b79714463425439486b4d69686e745858374a67442b4d4962724630505246514967535a54500a6b4f6c4a4b6361674f61753278514275546b4a392f6253396c723430616a53444e464e755770733d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a"

-- ClientID-org1-spender
export SPENDER="0a074f7267314d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b6a43434164436741774942416749515351792f487552466d6f62776665546a53365178346a414b42676771686b6a4f50515144416a427a4d5173770a435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e5532467549455a790a5957356a61584e6a627a455a4d4263474131554543684d5162334a6e4d53356c654746746347786c4c6d4e76625445634d426f474131554541784d54593245750a62334a6e4d53356c654746746347786c4c6d4e7662544165467730794e4441314d6a55784d444d794d4442614677307a4e4441314d6a4d784d444d794d4442610a4d477778437a414a42674e5642415954416c56544d524d77455159445651514945777044595778705a6d3979626d6c684d5259774641594456515148457731540a59573467526e4a68626d4e7063324e764d513877445159445651514c45775a6a62476c6c626e5178487a416442674e5642414d4d466c567a5a584978514739790a5a7a45755a586868625842735a53356a623230775754415442676371686b6a4f5051494242676771686b6a4f50514d4242774e434141522b566156567a5954610a445a747149672b594c4c4c36692b767868424979596f50714a3662334164706653705573306478646e4431744f75556179796f57386954545578782b475458770a344b734a45324468765569436f303077537a414f42674e56485138424166384542414d434234417744415944565230544151482f424149774144417242674e560a48534d454a4441696743435448795070734b73704e525342363534594b755638356f3867545839667a7844424b4e45546c4a2f62396a414b42676771686b6a4f0a5051514441674e49414442464169454178367134794470534158344d714a45722b7673424e335248736c773239674f384b3677544c6e66386f455143494752490a74326b5536304d354d6f74534271306279344b4c7235616f4e70702f76682b4f4d76557a6662576c0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a"

-- ClientID-org2
export RECIPIENT="0a074f7267324d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b6a4343416443674177494241674952414a7577656c3452684447787274385467764a4d764b4d77436759494b6f5a497a6a304541774977637a454c0a4d416b474131554542684d4356564d78457a415242674e5642416754436b4e6862476c6d62334a7561574578466a415542674e564241635444564e68626942470a636d467559326c7a593238784754415842674e5642416f54454739795a7a49755a586868625842735a53356a623230784844416142674e5642414d5445324e680a4c6d39795a7a49755a586868625842735a53356a623230774868634e4d6a51774e5449314d54417a4d6a41775768634e4d7a51774e54497a4d54417a4d6a41770a576a42724d517377435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e0a5532467549455a795957356a61584e6a627a454f4d4177474131554543784d465957527461573478487a416442674e5642414d4d466b466b62576c75514739790a5a7a49755a586868625842735a53356a623230775754415442676371686b6a4f5051494242676771686b6a4f50514d4242774e4341415259386756726b416a570a57702b5570413235453770422b385a424e624732576f315934372f74615979784159656e5476754e482b79415a547a4a4d6a7137397677782b4c536b3165355a0a676c48476b526332466d50716f303077537a414f42674e56485138424166384542414d434234417744415944565230544151482f424149774144417242674e560a48534d454a44416967434367504d4a4350695479586d6c364e50566a6f49474a6f783353626851485870344e3946677147713863666a414b42676771686b6a4f0a5051514441674e49414442464169454131796f767031325a324a2f6c4247556f37676a34556e755a5943574b73622b535774376163704b444b41514349482b770a5948624c56563344535a6265736944345964374332586c6f39514a5a4e6d383543397130624466300a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a"
