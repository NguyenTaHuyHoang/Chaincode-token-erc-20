./byfn.sh up -c mychannel -n

docker exec -it cli bash
 
peer chaincode install -n token_erc20 -v 1.0 -p github.com/chaincode/token-erc-20/go 

export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/users/Admin@org2.example.com/msp
export CORE_PEER_ADDRESS=peer0.org2.example.com:9051
export CORE_PEER_LOCALMSPID="Org2MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt
export CORE_PEER_TLS_ENABLED=true 

peer chaincode install -n token_erc20 -v 1.0 -p github.com/chaincode/token-erc-20/go 

export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/Admin@org1.example.com/msp
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export CORE_PEER_LOCALMSPID="Org1MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_TLS_ENABLED=true 

peer chaincode instantiate -o orderer.example.com:7050 --tls --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n token_erc20 -v 1.0 -c '{"Args":["Init"]}' -P "AND ('Org1MSP.peer','Org2MSP.peer')"

export TARGET_TLS_OPTIONS=(-o orderer.example.com:7050 --tls --cafile "/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem" --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles "/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt" --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles "/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt")

peer chaincode invoke -o orderer.example.com:7050 --tls true --cafile /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/ordererOrganizations/example.com/orderers/orderer.example.com/msp/tlscacerts/tlsca.example.com-cert.pem -C mychannel -n token_erc20 --peerAddresses peer0.org1.example.com:7051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt --peerAddresses peer0.org2.example.com:9051 --tlsRootCertFiles /opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org2.example.com/peers/peer0.org2.example.com/tls/ca.crt -c '{"function":"PrintCreatorAddress", "Args":[]}'

// Approve
Mở terminal mới và cd vào first-network

export CORE_PEER_MSPCONFIGPATH=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/users/User1@org1.example.com/msp
export CORE_PEER_ADDRESS=peer0.org1.example.com:7051
export CORE_PEER_LOCALMSPID="Org1MSP"
export CORE_PEER_TLS_ROOTCERT_FILE=/opt/gopath/src/github.com/hyperledger/fabric/peer/crypto/peerOrganizations/org1.example.com/peers/peer0.org1.example.com/tls/ca.crt
export CORE_PEER_TLS_ENABLED=true 


// Gọi hàm
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Initialize","Args":["ExampleToken","ETK","100000","18"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Mint","Args":["5000"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"ClientAccountBalance","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"ClientAccountID","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"transfer","Args":["'"$RECIPIENT"'","100"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Approve","Args":[ "'"$SPENDER"'","500"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"Allowance","Args":["'"$MINTER"'", "'"$SPENDER"'"]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"balanceOf","Args":[""]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"name","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"symbol","Args":[]}'
peer chaincode invoke "${TARGET_TLS_OPTIONS[@]}" -C mychannel -n token_erc20 -c '{"function":"totalSupply","Args":[]}'


- balanceOf là hàm yêu cầu lại số dư tài khoản của mint (totalSupply) trên tất cả các org và nó cần tham số truyền vào là account_ID_Org1_miner
- ClientAccountBalance là hàm yêu cầu số dư của người nhận hiện tại của org terminal đó
- transfer nó cần tham số truyền vào là  account_ID_org2
- transfer from (Chuyển khoản của bên thứ 3) là hoạt động trên terminal mới đại điện cho minter (mặc định org1) cần hai tham số truyền vào là  account_ID_Org1_miner và account ID Org2 


account ID Org1_miner =
eDUwOTo6Q049bWludGVyLE9VPWNsaWVudCxPPUh5cGVybGVkZ2VyLFNUPU5vcnRoIENhcm9saW5hLEM9VVM6OkNOPWNhLm9yZzEuZXhhbXBsZS5jb20sTz1vcmcxLmV4YW1wbGUuY29tLEw9RHVyaGFtLFNUPU5vcnRoIENhcm9saW5hLEM9VVM

// a 3rd terminal to represent the spender in Org1
account ID Org1_spender = eDUwOTo6Q049c3BlbmRlcixPVT1jbGllbnQsTz1IeXBlcmxlZGdlcixTVD1Ob3J0aCBDYXJvbGluYSxDPVVTOjpDTj1jYS5vcmcxLmV4YW1wbGUuY29tLE89b3JnMS5leGFtcGxlLmNvbSxMPUR1cmhhbSxTVD1Ob3J0aCBDYXJvbGluYSxDPVVT

account ID Org2 = eDUwOTo6Q049cmVjaXBpZW50LE9VPWNsaWVudCxPPUh5cGVybGVkZ2VyLFNUPU5vcnRoIENhcm9saW5hLEM9VVM6OkNOPWNhLm9yZzIuZXhhbXBsZS5jb20sTz1vcmcyLmV4YW1wbGUuY29tLEw9SHVyc2xleSxTVD1IYW1wc2hpcmUsQz1VSw


// encodedClientID := base64.StdEncoding.EncodeToString(clientID)
CgdPcmcxTVNQEqoGLS0tLS1CRUdJTiBDRVJUSUZJQ0FURS0tLS0tCk1JSUNLVENDQWMrZ0F3SUJBZ0lRWUUrNVloMGhwOW9jQlB3dEFrazZNakFLQmdncWhrak9QUVFEQWpCek1Rc3cKQ1FZRFZRUUdFd0pWVXpFVE1CRUdBMVVFQ0JNS1EyRnNhV1p2Y201cFlURVdNQlFHQTFVRUJ4TU5VMkZ1SUVaeQpZVzVqYVhOamJ6RVpNQmNHQTFVRUNoTVFiM0puTVM1bGVHRnRjR3hsTG1OdmJURWNNQm9HQTFVRUF4TVRZMkV1CmIzSm5NUzVsZUdGdGNHeGxMbU52YlRBZUZ3MHlOREExTWpRd056RTJNREJhRncwek5EQTFNakl3TnpFMk1EQmEKTUdzeEN6QUpCZ05WQkFZVEFsVlRNUk13RVFZRFZRUUlFd3BEWVd4cFptOXlibWxoTVJZd0ZBWURWUVFIRXcxVApZVzRnUm5KaGJtTnBjMk52TVE0d0RBWURWUVFMRXdWaFpHMXBiakVmTUIwR0ExVUVBd3dXUVdSdGFXNUFiM0puCk1TNWxlR0Z0Y0d4bExtTnZiVEJaTUJNR0J5cUdTTTQ5QWdFR0NDcUdTTTQ5QXdFSEEwSUFCQ1J3T2R0dTMvUnYKQjN2OXhkYi9aVVl0SlZWeUcyNFBpZEJIa3Y5OGM2RDNWNEZYeFE2MVdSQnFxUWcyRkZ6MnhUTFVHY215cFpqTQplTkJ0ZnBiMmZaR2pUVEJMTUE0R0ExVWREd0VCL3dRRUF3SUhnREFNQmdOVkhSTUJBZjhFQWpBQU1Dc0dBMVVkCkl3UWtNQ0tBSUpiRHZ1ME1VazYySUpHSWtUd0ptNm9pQlN5RTJVOUExN0VZMkt0ODBEWjhNQW9HQ0NxR1NNNDkKQkFNQ0EwZ0FNRVVDSVFEdEhmeDVLWWUvVFV0YU4wWHhqMkdQNTlyWkRCc0tRZUViSEJpZFhoNlU1UUlnWmpxbApnRlgzWFNtSmhmNTlnbEFIeDMyQnB1ZVFKTU9pQmZCUmpuM1NpUWM9Ci0tLS0tRU5EIENFUlRJRklDQVRFLS0tLS0K

// addressHex := hex.EncodeToString([]byte(clientID))
0a074f7267314d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b44434341632b674177494241674951487154697745587a4c674e4768514b6c496b4346487a414b42676771686b6a4f50515144416a427a4d5173770a435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e5532467549455a790a5957356a61584e6a627a455a4d4263474131554543684d5162334a6e4d53356c654746746347786c4c6d4e76625445634d426f474131554541784d54593245750a62334a6e4d53356c654746746347786c4c6d4e7662544165467730794e4441314d6a51784d544d774d4442614677307a4e4441314d6a49784d544d774d4442610a4d477378437a414a42674e5642415954416c56544d524d77455159445651514945777044595778705a6d3979626d6c684d5259774641594456515148457731540a59573467526e4a68626d4e7063324e764d513477444159445651514c457756685a473170626a45664d4230474131554541777757515752746157354162334a6e0a4d53356c654746746347786c4c6d4e766254425a4d424d4742797147534d34394167454743437147534d343941774548413049414247526d634362564b3767460a7a2f6e4c6d5930454841636c44504f4a30667864335155466547483979576a6b5835334a684737546563526c527172774365594f482b486a30794577717868530a4c62544a6c7336623446576a5454424c4d41344741315564447745422f775145417749486744414d42674e5648524d4241663845416a41414d437347413155640a4977516b4d434b41494b6a654d4338766a6f7949667670474c6e394542616d4d575a6a4d66515657647952384a724444354a6c644d416f4743437147534d34390a42414d43413063414d455143494631436d6768734f34772f7354702f686c6153694c57513959312f68716d5646756a49522b34505152414a41694239375965300a334f4d687a4c3765346d2f584c39373964617848744b58484b4664444a65693677344e7270513d3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a

-- ClientID-org1-miner
export MINTER="0a074f7267314d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b54434341632b67417749424167495158644a55717537746d7231492f3667446f4130426254414b42676771686b6a4f50515144416a427a4d5173770a435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e5532467549455a790a5957356a61584e6a627a455a4d4263474131554543684d5162334a6e4d53356c654746746347786c4c6d4e76625445634d426f474131554541784d54593245750a62334a6e4d53356c654746746347786c4c6d4e7662544165467730794e4441314d6a55774f4451784d4442614677307a4e4441314d6a4d774f4451784d4442610a4d477378437a414a42674e5642415954416c56544d524d77455159445651514945777044595778705a6d3979626d6c684d5259774641594456515148457731540a59573467526e4a68626d4e7063324e764d513477444159445651514c457756685a473170626a45664d4230474131554541777757515752746157354162334a6e0a4d53356c654746746347786c4c6d4e766254425a4d424d4742797147534d34394167454743437147534d34394177454841304941424b485153664d44513838540a70715541514f6952637a7a6f69444353614f515a38367769545347537551345a4d50384667334772554e32376246385773715349592f70625147676e496d30520a6554335a4472656f5233696a5454424c4d41344741315564447745422f775145417749486744414d42674e5648524d4241663845416a41414d437347413155640a4977516b4d434b41494141364837527675686447626c425a484d6e75345849523164306e7a317348696475755a7666742b7175444d416f4743437147534d34390a42414d43413067414d45554349514474442f4e484261674d6c57334d6f6256322b684f36745565375373394e433142764e364b6a514c6b434d77496742657a760a41446145483057644f45375a4271474747356f437a626132637a4e5162397444505a6130664c633d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a"

-- ClientID-org1-spender
export SPENDER="0a074f7267314d535012ae062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b7a4343416447674177494241674952414c6b576861627350444b7131446f577238676d47797377436759494b6f5a497a6a304541774977637a454c0a4d416b474131554542684d4356564d78457a415242674e5642416754436b4e6862476c6d62334a7561574578466a415542674e564241635444564e68626942470a636d467559326c7a593238784754415842674e5642416f54454739795a7a45755a586868625842735a53356a623230784844416142674e5642414d5445324e680a4c6d39795a7a45755a586868625842735a53356a623230774868634e4d6a51774e5449314d4467304d5441775768634e4d7a51774e54497a4d4467304d5441770a576a42734d517377435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e0a5532467549455a795957356a61584e6a627a45504d4130474131554543784d47593278705a5735304d523877485159445651514444425a56633256794d5542760a636d63784c6d56345957317762475575593239744d466b77457759484b6f5a497a6a3043415159494b6f5a497a6a30444151634451674145446d585552764c330a6a754650616f52726e48514f7274767066674f576e6f45556366646d4458477159706f7a626f646335327367492b4f6b543363506e395341634444764a4f684c0a643537774366504f3945792b5a614e4e4d45737744675944565230504151482f42415144416765414d41774741315564457745422f7751434d4141774b7759440a5652306a42435177496f416741446f6674472b3646305a7555466b637965376863684856335366505777654a3236356d392b333671344d77436759494b6f5a490a7a6a3045417749445341417752514968414f565a786e4c6b4b41456b64443174674e754c4f6b326630704150554c77683172434b30754a5047714155416942310a42693242596554327147435154383648633446527169516f536d6d534a344b4b4a79776357594a464d413d3d0a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a"

-- ClientID-org2
export RECIPIENT="0a074f7267324d535012aa062d2d2d2d2d424547494e2043455254494649434154452d2d2d2d2d0a4d4949434b6a4343416443674177494241674952414d464854667459757544714a366c4b785564666f756377436759494b6f5a497a6a304541774977637a454c0a4d416b474131554542684d4356564d78457a415242674e5642416754436b4e6862476c6d62334a7561574578466a415542674e564241635444564e68626942470a636d467559326c7a593238784754415842674e5642416f54454739795a7a49755a586868625842735a53356a623230784844416142674e5642414d5445324e680a4c6d39795a7a49755a586868625842735a53356a623230774868634e4d6a51774e5449314d4467304d5441775768634e4d7a51774e54497a4d4467304d5441770a576a42724d517377435159445651514745774a56557a45544d4245474131554543424d4b5132467361575a76636d3570595445574d4251474131554542784d4e0a5532467549455a795957356a61584e6a627a454f4d4177474131554543784d465957527461573478487a416442674e5642414d4d466b466b62576c75514739790a5a7a49755a586868625842735a53356a623230775754415442676371686b6a4f5051494242676771686b6a4f50514d4242774e434141524e77344c4c356e79440a6f754467494654412b413962596a32753334765456414a5a624c445464627a774b2f78546368377064737075614263534e436448787864366437342b546449580a6635442b6f506e653550434b6f303077537a414f42674e56485138424166384542414d434234417744415944565230544151482f424149774144417242674e560a48534d454a444169674341734e484d4732492f6f4338564d696a3046646b4972417133533876425255506d38627a58516545486b476a414b42676771686b6a4f0a5051514441674e4941444246416945416b5a777343326579703141376b5057342b466961355657377275785942304663474c547a4165435356383843494148540a366f373944793056724542655665746a327337425246452b41414968656d555a334c4f45763238450a2d2d2d2d2d454e442043455254494649434154452d2d2d2d2d0a"
